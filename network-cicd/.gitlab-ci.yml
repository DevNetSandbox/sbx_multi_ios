stages:
  - validate
  - deploy_to_test
  - deploy_to_prod


lint:
  stage: validate
  image: kecorbin/ansible:devel
  script:
    - ansible-playbook --syntax-check -i inventory.yaml site.yaml

deploy_to_test:
  image: kecorbin/ansible:devel
  stage: deploy_to_test
  script:
    - echo "Deploy to test env"
    - ansible-playbook -i inventory/test.yaml site.yaml
  environment:
    name: test
  only:
    - test

deploy_to_test:
  image: kecorbin/ansible:devel
  stage: deploy_to_prod
  script:
    - echo "Deploy to prod env"
    - ansible-playbook -i inventory/prod.yaml site.yaml
  environment:
    name: production
  only:
    - production
